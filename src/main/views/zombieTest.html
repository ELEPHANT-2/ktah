<html>
    <head>
    	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    	<script type="text/javascript" src="/js/lib/jquery-1.6.4.min.js"></script>
    	<script type="text/javascript" src="/js/ktah.js"></script>
    	<script type="text/javascript" src="/assets/copperlicht/copperlichtdata/copperlicht.js"></script>
    	<script type="text/javascript" src="/js/util/include.js"></script>
    	<title>Simple zombie demo</title>
    </head>
    <body>
        
        <!-- Auto-generated HTML; script lifted from Copperlicht tutorial to be later repurposed -->
        
    	<div align="center">
    		<canvas id="3darea" width="640" height="480" style="background-color:#000000">
    		</canvas>
    	</div>
    	<script type="text/javascript">
    	<!--
    	    var engine = startCopperLichtFromFile('3darea', '/assets/copperlicht/copperlichtdata/zombieTest.ccbjs'),
    	        zombieSceneNode = null,
                scene = null,
                key = null,
            
            // Rate of movement per second
            moveRate = 1.0,
            lastTime = 0.0,
            timeDiff = 0.0,

            // Variables for keyboard controls
            wDown = false,
            aDown = false,
            sDown = false,
            dDown = false;

            // Called when loading the 3d scene has finished (from the coppercube file)
            engine.OnLoadingComplete = function () {
                scene = engine.getScene();
                if (scene) {
                    // Grab the zombieSceneNode scene node
                    zombieSceneNode = scene.getSceneNodeFromName('ghoul');
                }
            }
            
            // Set up simple example keydown event
            document.onkeydown = function (event) {
                key = String.fromCharCode(event.keyCode);

                // When pressing w, move forward, s back
                // a move left, d move right
                switch (key) {
                    case 'w':
                    case 'W':
                       wDown = true;
                       break;
                    case 's':
                    case 'S':
                       sDown = true;
                       break;
                    case 'a':
                    case 'A':
                       aDown = true;
                       break;
                    case 'd':
                    case 'D':
                       dDown = true;
                       break;
                    default:
                       break;
                }
            }

            // Set up simple example keydown event
            document.onkeyup = function (event) {
                key = String.fromCharCode(event.keyCode);
                
                // When pressing w, move forward, s back
                // a move left, d move right
                switch (key) {
                    case 'w':
                    case 'W':
                       wDown = false;
                       break;
                    case 's':
                    case 'S':
                       sDown = false;
                       break;
                    case 'a':
                    case 'A':
                       aDown = false;
                       break;
                    case 'd':
                    case 'D':
                       dDown = false;
                       break;
                    default:
                       break;
                }
            }


        
            mainLoop = function () {
                //var secs = (new Date());
                //timeDiff = secs - lastTime;
                //lastTime = secs;
                if (wDown && zombieSceneNode) {
                    zombieSceneNode.Pos.X -= 1;//moveRate * timeDiff;
                }
                if (sDown && zombieSceneNode) {
                    zombieSceneNode.Pos.X += 1;//moveRate * timeDiff;
                }
                if (aDown && zombieSceneNode) {
                    zombieSceneNode.Pos.Z -= 1;//moveRate * timeDiff;
                }
                if (dDown && zombieSceneNode) {
                    zombieSceneNode.Pos.Z += 1;//moveRate * timeDiff;
                }
                setTimeout('mainLoop();', 20);
            }

            //var secs = (new Date()).getSeconds();
            mainLoop()
    	-->
    	</script>
    	<br/>
    </body>
</html>